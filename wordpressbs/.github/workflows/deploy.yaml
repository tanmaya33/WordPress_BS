name: Deploy WordPress_BS

on:
  push:
    branches:
      - main  # Trigger on push to the main branch

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
    # Step 1: Checkout the code from the repository
    - name: Checkout Code
      uses: actions/checkout@v3

    # Step 2: Deploy to AWS EC2 server
    - name: Deploy to Server
      run: |
        # Rsync to sync the local WordPress files with the EC2 instance
        rsync -avz --delete ./ ubuntu@3.110.204.39:/var/www/html/wordpress/
        
        # SSH to restart Nginx and apply changes
        ssh -i your-key.pem ubuntu@3.110.204.39 "sudo systemctl restart nginx"
      env:
        SSH_PRIVATE_KEY: ${{ secrets.SSH_PRIVATE_KEY }}  # Use GitHub secrets for private key
